<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<title>Murat Sağlam – Portfolyo</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Libre+Baskerville:wght@700&display=swap" rel="stylesheet">
<style>
:root{ --bg:#fff; --text:#111; --muted:#7a7a7a; --gap:6px; --accent-green: #1e7f62; }
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--text); font-family: Inter, system-ui, Arial, sans-serif;}
img{max-width:100%;display:block}
a{color:inherit; text-decoration:none;}

/* Header */
header{
  position:sticky;top:0;z-index:40;
  background:rgba(255,255,255,.92);
  backdrop-filter:saturate(160%) blur(8px);
  border-bottom:1px solid rgba(0,0,0,.06)
}
.brand-container{
  text-align:center; padding:12px 10px;
}
.brand-container img {
  height: 80px;
  width: auto;
  max-width: 320px;
  display: inline-block;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}

/* Sekmeli Navigasyon */
nav{
  display:flex; flex-wrap: wrap; gap:24px;justify-content:center;padding:10px 0 14px;
  font-size:12px; letter-spacing:.2em;
  text-transform:uppercase;color:var(--muted);
  border-top: 1px solid rgba(0,0,0,.06);
}
nav a{
  color:inherit;text-decoration:none;opacity:.8; cursor:pointer;
  padding-bottom: 4px; border-bottom: 2px solid transparent;
  transition: all .2s ease;
}
nav a:hover{color:#000;opacity:1}
nav a[data-target].active{
  color: #000;
  opacity: 1;
  border-bottom-color: #000;
}

/* Galeriler */
.gallery{
  display:grid;grid-template-columns:repeat(4,1fr);
  gap:var(--gap);padding:var(--gap)
}
.hidden { display: none !important; }
.tile{position:relative;overflow:hidden;cursor:pointer;background:#ddd;border-radius:2px}
.tile .bg, .tile img {
  width:100%;aspect-ratio:16/9;
  object-fit: cover;
  background-size:cover;background-position:center;transform:scale(1.01);
  transition:transform .2s ease
}
.tile:hover .bg, .tile:hover img {transform:scale(1.035)}
.tile .grade{
  position:absolute;inset:0;mix-blend:multiply;pointer-events:none;
  background:linear-gradient(180deg,rgba(28,62,54,.12),rgba(255,195,113,.10))
}
.tile .overlay{
  position:absolute;inset:0;background:rgba(0,0,0,.12);
  opacity:0;transition:opacity .2s ease
}
.tile:hover .overlay{opacity:1}
.play{
  position:absolute;right:10px;bottom:10px;width:44px;height:44px;border-radius:11px;
  background:rgba(255,255,255,.9);border:1px solid rgba(0,0,0,.12)
}
.play::before{
  content:'';position:absolute;left:18px;top:14px;border-left:12px solid #111;
  border-top:9px solid transparent;border-bottom:9px solid transparent
}

/* Buton Tasarımı */
.youtube-cta-section {
    text-align: center;
    padding: 50px var(--gap) 60px;
    transition: opacity 0.3s ease;
}
.cta-button {
    display: inline-block;
    background: #ffffff;
    color: var(--accent-green);
    border: 1px solid #e5e7eb;
    padding: 16px 32px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 16px;
    text-decoration: none;
    box-shadow: 0 4px 10px rgba(0,0,0,.06), inset 0 1px 1px #fff;
    transition: all .2s ease;
}
.cta-button:hover {
    transform: translateY(-3px);
    box-shadow: 0 7px 14px rgba(0,0,0,.08), inset 0 1px 1px #fff;
    border-color: #d1d5db;
    color: #111;
}

/* Modals */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.92);display:none;place-items:center;z-index:9999;padding:24px}
.modal.open{display:grid}
.player, .image-viewer{width:min(100%,1200px)}
.player iframe{width:100%;aspect-ratio:16/9;border:0;border-radius:12px;background:#000}
.image-viewer img {
    width: 100%; height: auto; max-height: 90vh;
    object-fit: contain; border-radius: 12px;
}
.close{
  position:absolute;top:16px;right:18px;width:42px;height:42px;border-radius:11px;
  border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.9);
  display:grid;place-items:center;font-size:22px;cursor:pointer
}

/* Responsive */
@media (max-width:1200px){ .gallery{grid-template-columns:repeat(3,1fr)} }
@media (max-width:820px){ 
    .gallery{grid-template-columns:repeat(2,1fr)} 
    .brand-container img { height: 60px; max-width: 240px; }
}
@media (max-width:640px){
    nav a { font-size: 11px; gap: 18px; }
    .brand-container img { height: 50px; max-width: 180px; }
    .cta-button { padding: 14px 24px; font-size: 14px;}
}
</style>
</head>
<body>

<header>
  <div class="brand-container">
    <a href="/" title="Ana Sayfa"><img src="img/logo.png" alt="Murat Sağlam Logo"></a>
  </div>
  <nav id="gallery-nav">
    <a href="/">Ana Sayfa</a>
    <a data-target="video-gallery" class="active">Video</a>
    <a data-target="photo-gallery">Fotoğraflar</a>
    <a data-target="design-gallery">Tasarımlar</a>
    <a href="hizmetler.html">Hizmetler</a>
    <a href="mailto:muratsaglam@hotmail.com.tr">İletişim</a>
  </nav>
</header>

<main>
  <section class="gallery" id="video-gallery"></section>
  <section class="gallery hidden" id="photo-gallery"></section>
  <section class="gallery hidden" id="design-gallery"></section>
  <section class="youtube-cta-section">
    <a href="https://www.youtube.com/@muratsaglamco/videos" class="cta-button" target="_blank" rel="noopener">
      Tüm videoları izlemek için YouTube kanalımızı ziyaret edin!
    </a>
  </section>
</main>

<div class="modal" id="ytModal"><div class="player"><iframe id="ytFrame" src="" allow="autoplay; encrypted-media; picture-in-picture" allowfullscreen></iframe></div><button class="close" id="closeYtModal" aria-label="Kapat">×</button></div>
<div class="modal" id="imgModal"><div class="image-viewer"><img id="modalImg" src=""></div><button class="close" id="closeImgModal" aria-label="Kapat">×</button></div>

<script>
document.addEventListener('DOMContentLoaded', () => {

  // --- YOUTUBE VİDEOLARINI ÇEKME FONKSİYONU ---
  const fetchYouTubeVideos = () => {
    const container = document.getElementById('video-gallery');
    if (!container) return;
    container.innerHTML = '<p style="text-align:center; padding: 20px; width: 100%; grid-column: 1 / -1;">Videolar yükleniyor...</p>';
    const API_URL = `/.netlify/functions/youtube`;

    fetch(API_URL)
      .then(response => {
        if (!response.ok) {
          return response.json().then(err => Promise.reject(err));
        }
        return response.json();
      })
      .then(videos => {
        container.innerHTML = '';
        if (!videos || videos.length === 0) {
          container.innerHTML = '<p>Herkese açık video bulunamadı.</p>';
          return;
        }
        videos.forEach(video => {
          const figure = document.createElement('figure');
          figure.className = 'tile video-tile';
          figure.dataset.yt = video.videoId;
          figure.title = video.title;
          figure.innerHTML = `<div class="bg" style="background-image:url('${video.thumbnailUrl}')"></div><div class="grade"></div><div class="overlay"><div class="play"></div></div>`;
          container.appendChild(figure);
        });
      })
      .catch(error => {
        console.error('Detaylı Hata:', error);
        let errorMessage = 'Bilinmeyen bir hata oluştu.';
        if (error.message) {
          errorMessage = `<b>Ana Hata:</b> ${error.message}<br>`;
        }
        if (error.errorDetails && Array.isArray(error.errorDetails)) {
            errorMessage += `<b>Google API Hatası:</b> ${error.errorDetails[0].message} (${error.errorDetails[0].reason})`;
        } else if (error.errorDetails) {
            errorMessage += `<b>Detaylar:</b> ${JSON.stringify(error.errorDetails)}`;
        }
        container.innerHTML = `<div style="padding:20px; font-family: monospace; text-align: left; color: red; background: #fff0f0; border: 1px solid red; border-radius: 8px; grid-column: 1 / -1;">${errorMessage}</div>`;
      });
  };

  // --- FOTOĞRAF VE TASARIM GALERİLERİNİ OTOMATİK OLUŞTURMA FONKSİYONU ---
  const generateLocalGallery = (folder, containerId) => {
    const container = document.getElementById(containerId);
    if (!container) return;
    const extensions = ['jpg', 'jpeg', 'png', 'gif', 'webp'];
    let currentNumber = 1, attempts = 0; const maxAttempts = 5;
    const checkNextImage = () => {
      if (attempts >= maxAttempts) return;
      let foundForThisNumber = false, extensionsChecked = 0;
      extensions.forEach(ext => {
        const imageUrl = `${folder}/${currentNumber}.${ext}`;
        const img = new Image();
        img.src = imageUrl;
        img.onload = () => {
          if (foundForThisNumber) return;
          foundForThisNumber = true; attempts = 0;
          const figure = document.createElement('figure');
          figure.className = 'tile image-tile';
          figure.title = `Eser ${currentNumber}`;
          figure.innerHTML = `<img src="${imageUrl}" alt="Eser ${currentNumber}" loading="lazy"><div class="grade"></div><div class="overlay"></div>`;
          container.appendChild(figure);
          currentNumber++; checkNextImage();
        };
        img.onerror = () => { extensionsChecked++; if (!foundForThisNumber && extensionsChecked === extensions.length) { currentNumber++; attempts++; checkNextImage(); }};
      });
    };
    checkNextImage();
  };

  // --- SEKMELER VE MODAL PENCERELER İÇİN EVENT LISTENER'LAR ---
  const mainContent = document.querySelector('main');
  const navLinks = document.querySelectorAll('#gallery-nav a');
  const galleries = document.querySelectorAll('main .gallery');
  const tabLinks = document.querySelectorAll('#gallery-nav a[data-target]');
  const youtubeCtaSection = document.querySelector('.youtube-cta-section');
  const ytModal = document.getElementById('ytModal');
  const ytFrame = document.getElementById('ytFrame');
  const closeYtBtn = document.getElementById('closeYtModal');
  const imgModal = document.getElementById('imgModal');
  const modalImg = document.getElementById('modalImg');
  const closeImgBtn = document.getElementById('closeImgModal');

  function closeYT(){ ytFrame.src = ''; ytModal.classList.remove('open'); document.body.style.overflow = ''; }
  function closeImage(){ modalImg.src = ''; imgModal.classList.remove('open'); document.body.style.overflow = ''; }

  closeYtBtn.addEventListener('click', closeYT);
  ytModal.addEventListener('click', e => { if (e.target === ytModal) closeYT(); });
  closeImgBtn.addEventListener('click', closeImage);
  imgModal.addEventListener('click', e => { if (e.target === imgModal) closeImage(); });
  
  mainContent.addEventListener('click', (e) => {
    const videoTile = e.target.closest('.video-tile');
    if (videoTile && videoTile.dataset.yt) {
      ytFrame.src = `https://www.youtube.com/embed/${videoTile.dataset.yt}?autoplay=1&rel=0&playsinline=1`;
      ytModal.classList.add('open');
      document.body.style.overflow = 'hidden';
      return;
    }
    const imageTile = e.target.closest('.image-tile');
    if (imageTile) {
      const imgSrc = imageTile.querySelector('img')?.src;
      if (imgSrc) {
        modalImg.src = imgSrc;
        imgModal.classList.add('open');
        document.body.style.overflow = 'hidden';
      }
    }
  });

  navLinks.forEach(link => {
    link.addEventListener('click', (e) => {
      if (!link.hasAttribute('data-target')) return;
      e.preventDefault(); 
      const targetId = link.getAttribute('data-target');
      tabLinks.forEach(nav => nav.classList.remove('active'));
      link.classList.add('active');
      galleries.forEach(gallery => {
        gallery.classList.toggle('hidden', gallery.id !== targetId);
      });
      if (youtubeCtaSection) {
        youtubeCtaSection.classList.toggle('hidden', targetId !== 'video-gallery');
      }
    });
  });

  // --- TÜM OTOMASYONLARI BAŞLAT ---
  fetchYouTubeVideos();
  generateLocalGallery('img/foto', 'photo-gallery');
  generateLocalGallery('img/tsrm', 'design-gallery');
  
});
</script>

</body>
</html>
